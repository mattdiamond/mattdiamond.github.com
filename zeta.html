<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Riemann Zeta partial sums</title>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.6/dat.gui.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.2/paper-core.min.js"></script>
	<script type="text/javascript">
		function init(){
			setUpPaper();
			initZeta();
		}

		function setUpPaper(){
			myCanvas.width = window.innerWidth;
			myCanvas.height = window.innerHeight;
			paper.install(window);
			paper.setup('myCanvas');
			view.zoom = 100;
		}

		function initZeta(){
			window.zeta = new Zeta();

			//set up GUI
			const gui = new dat.GUI();
			gui.add(zeta, 're');
			zeta.imController = gui.add(zeta, 'im').step(0.001);
			gui.add(zeta, 'imRate').step(0.001);
			gui.add(zeta, 'animate');
			gui.add(zeta, 'reset');

			zeta.draw();
		}

		function Zeta(){
			this.re = 0.5;
			this.im = 0;
			this.imRate = 0.02;
			this.animate = true;
			this.reset = function(){
				this.imController.setValue(0);
			};
			this.path = new Path({
				strokeColor: 'black',
				strokeWidth: 0.01
			});
		}

		Zeta.prototype.draw = function(){
			view.onFrame = () => {
				this.path.clear();
				this.path.add(view.center);

				const max = Math.max(Math.floor(this.im / 3), 250);
				document.getElementById('sums-count').innerText = max;

				// draw partial sums as an angle path
				let angle = 0;
				for (let n = 1; n <= max; n++) {
					const point = new Point({
						angle: radToDeg(angle),
						length: n ** -this.re
					});
					this.path.lineBy(point);
					angle += this.im * Math.log(1 + 1/n);
				}
				if (this.animate) {
					this.im += this.imRate;
					this.imController.updateDisplay();
				}
			};
		};

		function radToDeg (angle) {
			return angle * (180 / Math.PI);
		}

		window.onload = init;
	</script>
	<style type="text/css">
		html, body {
			height: 100%;
			width: 100%;
			margin: 0;
			padding: 0;
		}

		canvas {
			float: left;
		}

		.info {
			font-family: 'Helvetica Neue', Helvetica, sans-serif;
			font-weight: 300;
			font-size: 20px;
			position: absolute;
			top: 0;
			left: 0;
			padding: 10px;
		}
	</style>
</head>
<body>
	<canvas id='myCanvas'></canvas>
	<div class='info'>
		First <span id='sums-count'></span> partial sums of the
		<a href='https://en.wikipedia.org/wiki/Riemann_zeta_function' target='_blank'>
			Riemann zeta function
		</a>
	</div>
</body>
</html>
